<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <style>
        table {
            border-collapse: collapse;
        }

        table, td, th {
            border: 1px solid black;
        }
    </style>
</head>
<body>
<div style="display: block; margin-left: 10%;">

    <button type="button" onclick="action()">Start</button>
    <button type="button" onclick="action()">Stop</button>
    <p>Option 1: Send input text patterns</p>
    <input type="text" id="input">
    <button type="button" onclick="save2()">Send</button>
    <p><br>Option 2: Send customer patterns</p>
    <button type="button" onclick="buildNewTable()">Add</button>
    <button type="button" onclick="RemoveLastTable()">Remove</button>
    <button type="button" onclick="save1()">Send</button>
    <div id="visual" style="margin-top: 10px;">
    </div>

</div>
<script>
    var tablelist = [];
    function buildNewTable() {
        var body = document.getElementById("visual");
        var tb1 = document.createElement('table');

        tb1.style.float = "left";
        tb1.style.marginRight = "20px";
        tb1.style.marginTop = "20px";

        for (var i = 0; i < 8; i++) {
            var tr = tb1.insertRow();
            for (var j = 0; j < 8; j++) {
                var td = tr.insertCell();
                td.width = '40px';
                td.height = "40px";
                td.style = "background-color:lightyellow";
            }
        }
        if (tb1 != null) {
            for (var i = 0; i < tb1.rows.length; i++) {
                for (var j = 0; j < tb1.rows[i].cells.length; j++)
                    tb1.rows[i].cells[j].onclick = function () {
                        selectcell(this);
                    };
            }
        }
        tablelist.push(tb1);
        body.appendChild(tb1);
    }
    function RemoveLastTable() {
        var body = document.getElementById("visual");
        var tb = tablelist[tablelist.length-1];
        body.removeChild(tb);
        tablelist.pop();
    }
    buildNewTable();
    function selectcell(cel) {
        if (cel.style.backgroundColor == 'red')
            cel.style.backgroundColor = 'lightyellow';
        else
            cel.style.backgroundColor = 'red';
    }
    function save1() {
        var res = [];
        for (var k = 0; k < tablelist.length; k++) {
            var tb = tablelist[k];
            var tmp = [];
            if (tb != null) {
                for (var i = 0; i < tb.rows.length; i++) {
                    tmp[i] = [];
                    for (var j = 0; j < tb.rows[i].cells.length; j++) {
                        if (tb.rows[i].cells[j].style.backgroundColor == 'red')
                            tmp[i][j] = 1;
                        else
                            tmp[i][j] = 0;
                    }
                }
                res[k] = tmp;
            }
        }
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "/save",
            data: JSON.stringify({res1: res}),
            success: function (data) {
                alert("DONE!")
            },
            dataType: "json"
        })
    }
    function save2() {
        var tb = document.getElementById("input").value;

        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "/save",
            data: JSON.stringify({res2: tb}),
            success: function (data) {
                alert("DONE!")
            },
            dataType: "json"
        })
    }
</script>
</body>
</html>